<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>sorvi vignette &mdash; rOpenGov</title>
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/assets/main.css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" />
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="/images/logo.png"/>
  <link href="/feed.xml" rel="alternate" type="application/rss+xml" title="rOpenGov" />
  <meta name="title" content="sorvi vignette ">
  <link rel="canonical" href="http://ropengov.github.io/tutorials/sorvi_tutorial/">
   
         
  <meta property="og:title" content="sorvi vignette "/>
  <meta property="og:url" content="http://ropengov.github.io/tutorials/sorvi_tutorial/"/>
  
  
  <meta property="og:site_name" content="rOpenGov">     
</head>
<body>
  
  <section class="site-nav">
  <header>
      <nav id="navigation">
          <a class="brand" href="/">
              <img src="/images/logo.png" alt="rOpenGov">
          </a>
          <a href="/" class="home">Blog</a>
          
          <a href="http://ropengov.github.io/projects">Projects</a>
          <a href="http://ropengov.github.io/about">About</a>
          <a href="http://ropengov.github.io/contribute">Contribute</a>          
      </nav>
      
  </header>
  </section>

  <article class="container">

  <div class="span11">
  <div class="row">

  <header class="jumbotron subhead" id="overview"> 
     <iframe src="http://ghbtns.com/github-btn.html?user=ropengov&repo=sorvi&type=watch&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="170" height="30" align="right"></iframe>
     <iframe src="http://ghbtns.com/github-btn.html?user=ropengov&repo=sorvi&type=fork&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="170" height="30" align="right"></iframe>      

     <h1> <i class="fa fa-book"></i>  sorvi <small>v0.4.25</small> </h1>
  </header>
    
  </div>
  <!-- <br> -->

  <div class"row"> <h2> <em> Algorithms for Finnish Open Government Data </em> </h2>

  <!-- <h3><i class="ss-icon" style="color:#ebeef6;">&#x2139;</i>&nbsp;&nbsp;This is the vignette in the sorvi package</h3> -->
  <br>

  <center><a href="https://github.com/ropengov/sorvi/" style="color:#ffffff" target="_blank"> <button class="btn btn-success btn-large" style="display: block; width: 75%;"><i class="icon-white icon-download"></i>Download from GitHub</button></a></center>
  <br>
  <!-- <hr class="soften"> -->
  </div>
  <div class="span11">
  <h1 id="finnish_open_government_data_toolkit_for_r">Finnish open government data toolkit for R</h1>

<p>This is an R package for Finnish open government data. New contributions are <a href="http://louhos.github.com/contact.html">welcome!</a>.</p>

<p>This work is part of the <a href="http://ropengov.github.com">rOpenGov</a> project.</p>

<h2 id="installation">Installation</h2>

<p>General users (CRAN release version):</p>
<div class='highlight'><pre><code class='r'>install.packages<span class='p'>(</span><span class='s'>&quot;sorvi&quot;</span><span class='p'>)</span>
library<span class='p'>(</span>sorvi<span class='p'>)</span>
</code></pre></div>
<p>Developers (Github development version):</p>
<div class='highlight'><pre><code class='r'>install.packages<span class='p'>(</span><span class='s'>&quot;devtools&quot;</span><span class='p'>)</span>
library<span class='p'>(</span>devtools<span class='p'>)</span>
install_github<span class='p'>(</span><span class='s'>&quot;sorvi&quot;</span><span class='p'>,</span> <span class='s'>&quot;ropengov&quot;</span><span class='p'>)</span>
library<span class='p'>(</span>sorvi<span class='p'>)</span>
</code></pre></div>
<p>Further installation and development instructions can be found at the project <a href="http://ropengov.github.com/sorvi">home page</a>.</p>

<h2 id="using_the_package">Using the package</h2>

<p>For further usage examples, see <a href="http://louhos.wordpress.com">Louhos-blog</a> and <a href="https://github.com/louhos/sorvi/wiki/Data">Datawiki</a>.</p>

<h3 id="personal_identification_number_hetu">Personal identification number (HETU)</h3>

<p>Extracting information from a Finnish personal identification number:</p>
<div class='highlight'><pre><code class='r'>library<span class='p'>(</span>sorvi<span class='p'>)</span>
hetu<span class='p'>(</span><span class='s'>&quot;111111-111C&quot;</span><span class='p'>)</span>
</code></pre></div><div class='highlight'><pre><code class='text'>## $hetu
## [1] &quot;111111-111C&quot;
## 
## $gender
## [1] &quot;Male&quot;
## 
## $personal.number
## [1] 111
## 
## $checksum
## [1] &quot;C&quot;
## 
## $date
## [1] &quot;1911-11-11&quot;
## 
## $day
## [1] 11
## 
## $month
## [1] 11
## 
## $year
## [1] 1911
## 
## $century.char
## [1] &quot;-&quot;
## 
## attr(,&quot;class&quot;)
## [1] &quot;hetu&quot;
</code></pre></div>
<p>Validating Finnish personal identification number:</p>
<div class='highlight'><pre><code class='r'>valid.hetu<span class='p'>(</span><span class='s'>&quot;010101-0101&quot;</span><span class='p'>)</span>  <span class='c1'># TRUE/FALSE</span>
</code></pre></div><div class='highlight'><pre><code class='text'>## [1] TRUE
</code></pre></div>
<h3 id="postal_codes">Postal codes</h3>

<p>Get Finnish postal codes vs. municipalities table from Wikipedia</p>
<div class='highlight'><pre><code class='r'>postal.code.table <span class='o'>&lt;-</span> GetPostalCodeInfo<span class='p'>()</span>
head<span class='p'>(</span>postal.code.table<span class='p'>)</span>
</code></pre></div>
<h3 id="ip_location">IP Location</h3>

<p>Get geographic coordinates for a given IP-address from http://www.datasciencetoolkit.org//ip2coordinates/</p>
<div class='highlight'><pre><code class='r'>ip_location<span class='p'>(</span><span class='s'>&quot;137.224.252.10&quot;</span><span class='p'>)</span>
</code></pre></div><div class='highlight'><pre><code class='text'>## [1] &quot;51.9667015075684&quot; &quot;5.66669988632202&quot;
</code></pre></div>
<h3 id="municipality_information">Municipality information</h3>

<p>Finnish municipality information is available through Population Registry (Vaestorekisterikeskus), Statistics Finland (Tilastokeskus) and Land Survey Finland (Maanmittauslaitos). We provide separate download routine for each data set. The row names are in harmonized format and can be used to match data sets from different sources, as different data sets may carry slightly different versions of certain municipality names. Examples for each case:</p>

<p>Finnish municipality information from Land Survey Finland (<a href="http://www.maanmittauslaitos.fi/aineistot-palvelut/latauspalvelut/avoimien-aineistojen-tiedostopalvelu">Maanmittauslaitos, MML</a>).</p>
<div class='highlight'><pre><code class='r'>municipality.info.mml <span class='o'>&lt;-</span> GetMunicipalityInfoMML<span class='p'>()</span>
municipality.info.mml<span class='p'>[</span><span class='m'>1</span><span class='o'>:</span><span class='m'>2</span><span class='p'>,</span> <span class='p'>]</span>
</code></pre></div>
<p>Get information of Finnish provinces from Statistics Finland (<a href="http://pxweb2.stat.fi/Database/Kuntien%20perustiedot/Kuntien%20perustiedot/Kuntaportaali.px">Tilastokeskus</a>)</p>
<div class='highlight'><pre><code class='r'>municipality.info.statfi <span class='o'>&lt;-</span> GetMunicipalityInfoStatFi<span class='p'>()</span>
municipality.info.statfi<span class='p'>[</span><span class='m'>1</span><span class='o'>:</span><span class='m'>2</span><span class='p'>,</span> <span class='p'>]</span>
</code></pre></div>
<p>List the province for each municipality in Finland:</p>
<div class='highlight'><pre><code class='r'><span class='c1'># Specific municipalities</span>
m2p <span class='o'>&lt;-</span> FindProvince<span class='p'>(</span>c<span class='p'>(</span><span class='s'>&quot;Helsinki&quot;</span><span class='p'>,</span> <span class='s'>&quot;Tampere&quot;</span><span class='p'>,</span> <span class='s'>&quot;Turku&quot;</span><span class='p'>))</span>
head<span class='p'>(</span>m2p<span class='p'>)</span>

<span class='c1'># All municipalities</span>
m2p <span class='o'>&lt;-</span> FindProvince<span class='p'>(</span>municipality.info.statfi<span class='o'>$</span>Kunta<span class='p'>)</span>

<span class='c1'># Speeding up with predefined municipality info table:</span>
m2p <span class='o'>&lt;-</span> FindProvince<span class='p'>(</span>c<span class='p'>(</span><span class='s'>&quot;Helsinki&quot;</span><span class='p'>,</span> <span class='s'>&quot;Tampere&quot;</span><span class='p'>,</span> <span class='s'>&quot;Turku&quot;</span><span class='p'>),</span> municipality.info.mml<span class='p'>)</span>
head<span class='p'>(</span>m2p<span class='p'>)</span>
</code></pre></div>
<p>Convert municipality codes and names:</p>
<div class='highlight'><pre><code class='r'>municipality_ids <span class='o'>&lt;-</span> ConvertMunicipalityCodes<span class='p'>()</span>
head<span class='p'>(</span>municipality_ids<span class='p'>)</span>
</code></pre></div>
<p>Translate municipality names Finnish/English:</p>
<div class='highlight'><pre><code class='r'>translations <span class='o'>&lt;-</span> LoadData<span class='p'>(</span><span class='s'>&quot;translations&quot;</span><span class='p'>)</span>
head<span class='p'>(</span>translations<span class='p'>)</span>
</code></pre></div><div class='highlight'><pre><code class='text'>##   Ã\u0085land Islands         South Karelia Southern Ostrobothnia 
##          &quot;Ahvenanmaa&quot;      &quot;EtelÃĪ-Karjala&quot;    &quot;EtelÃĪ-Pohjanmaa&quot; 
##      Southern Savonia                Kainuu       Tavastia Proper 
##         &quot;EtelÃĪ-Savo&quot;              &quot;Kainuu&quot;         &quot;Kanta-HÃĪme&quot;
</code></pre></div>
<h3 id="retrieve_population_register_data">Retrieve population register data</h3>

<p>Municipality-level population information from <a href="http://vrk.fi/default.aspx?docid=5127&site=3&id=0">Vaestorekisterikeskus</a>:</p>
<div class='highlight'><pre><code class='r'>df <span class='o'>&lt;-</span> GetPopulationRegister<span class='p'>()</span>
head<span class='p'>(</span>df<span class='p'>)</span>
</code></pre></div><div class='highlight'><pre><code class='text'>##           Koodi     Kunta    Kommun  Male Female Total
## Äänekoski   992 Äänekoski Äänekoski 10187  10121 20308
## Ähtäri      989    Ähtäri    Etseri  3231   3222  6453
## Akaa        020      Akaa      Akaa  8452   8637 17089
## Alajärvi    005  Alajärvi  Alajärvi  5226   5214 10440
## Alavieska   009 Alavieska Alavieska  1420   1350  2770
## Alavus      010    Alavus    Alavus  4619   4634  9253
</code></pre></div>
<h3 id="province_information">Province information</h3>

<p>Get information of Finnish provinces from Wikipedia:</p>
<div class='highlight'><pre><code class='r'>tab <span class='o'>&lt;-</span> GetProvinceInfoWikipedia<span class='p'>()</span>
head<span class='p'>(</span>tab<span class='p'>)</span>
</code></pre></div><div class='highlight'><pre><code class='text'>##          Province  Area Population PopulationDensity
## 1         Uusimaa  9132    1550362             170.4
## 2 Varsinais-Suomi 10664     457789              42.9
## 3       Satakunta  7956     229360              28.8
## 4      Kanta-Häme  5199     169952              32.7
## 5       Pirkanmaa 12446     472181              37.9
## 6     Päijät-Häme  5127     199235              38.9
</code></pre></div>
<h3 id="company_subsidies_from_the_finnish_government">Company subsidies from the Finnish government</h3>

<p>Finnish broadcasting company YLE published a large data set on Finnish company subsidies (<a href="http://ohjelmat.yle.fi/mot/10_9">(C) MOT 10.9.2012</a> over 15 years. See the site for more information; CC-BY-SA 3.0-license.</p>
<div class='highlight'><pre><code class='r'>tuet <span class='o'>&lt;-</span> GetMOTYritystuet<span class='p'>()</span>
head<span class='p'>(</span>tuet<span class='p'>)</span>
</code></pre></div>
<h3 id="visualization_routines">Visualization routines</h3>

<p>Line fit with confidence smoothers:</p>
<div class='highlight'><pre><code class='r'>library<span class='p'>(</span>sorvi<span class='p'>)</span>
data<span class='p'>(</span>iris<span class='p'>)</span>
p <span class='o'>&lt;-</span> vwReg<span class='p'>(</span>Sepal.Length <span class='o'>~</span> Sepal.Width<span class='p'>,</span> iris<span class='p'>)</span>
print<span class='p'>(</span>p<span class='p'>)</span>
</code></pre></div>
<p>Plot matrix:</p>
<div class='highlight'><pre><code class='r'>mat <span class='o'>&lt;-</span> rbind<span class='p'>(</span>c<span class='p'>(</span><span class='m'>1</span><span class='p'>,</span> <span class='m'>2</span><span class='p'>,</span> <span class='m'>3</span><span class='p'>),</span> c<span class='p'>(</span><span class='m'>1</span><span class='p'>,</span> <span class='m'>3</span><span class='p'>,</span> <span class='m'>1</span><span class='p'>),</span> c<span class='p'>(</span><span class='m'>4</span><span class='p'>,</span> <span class='m'>2</span><span class='p'>,</span> <span class='m'>2</span><span class='p'>))</span>
pm <span class='o'>&lt;-</span> PlotMatrix<span class='p'>(</span>mat<span class='p'>,</span> <span class='s'>&quot;twoway&quot;</span><span class='p'>,</span> midpoint <span class='o'>=</span> <span class='m'>2</span><span class='p'>)</span>
</code></pre></div>
<p><img src="../../figs/sorvi_tutorial/unnamed-chunk-1.png" alt="plot of chunk unnamed-chunk-1" /></p>
<div class='highlight'><pre><code class='r'><span class='c1'># Plotting the scale sc &lt;- PlotScale(pm$colors, pm$breaks)</span>
</code></pre></div>
<h2 id="licensing_and_citations">Licensing and Citations</h2>

<p>This work can be freely used, modified and distributed under the <a href="http://en.wikipedia.org/wiki/BSD\_licenses">Two-clause FreeBSD license</a>.</p>

<p>Kindly cite the work, if appropriate, as ‘Leo Lahti, Juuso Parkkinen ja Joona Lehtomaki (2011). sorvi - suomalainen avoimen datan tyokalupakki. URL: http://louhos.github.com/sorvi)’. A full list of authors and contributors and the relevant contact information is <a href="http://louhos.github.com/contact">here</a>.</p>

<h2 id="session_info">Session info</h2>

<p>This vignette was created with</p>
<div class='highlight'><pre><code class='r'>sessionInfo<span class='p'>()</span>
</code></pre></div><div class='highlight'><pre><code class='text'>## R version 3.0.3 (2014-03-06)
## Platform: x86_64-apple-darwin10.8.0 (64-bit)
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] methods   stats     graphics  grDevices utils     datasets  base     
## 
## other attached packages:
##  [1] sorvi_0.4.25    helsinki_0.9.13 RCurl_1.95-4.1  bitops_1.0-6   
##  [5] rjson_0.2.13    mapproj_1.2-2   maps_2.3-6      ggmap_2.3      
##  [9] ggplot2_0.9.3.1 rgeos_0.3-4     maptools_0.8-29 fingis_0.9.9   
## [13] rgdal_0.8-16    sp_1.0-14       knitr_1.5      
## 
## loaded via a namespace (and not attached):
##  [1] boot_1.3-10         coda_0.16-1         colorspace_1.2-4   
##  [4] deldir_0.1-5        dichromat_2.0-0     digest_0.6.4       
##  [7] evaluate_0.5.1      foreign_0.8-60      formatR_0.10       
## [10] grid_3.0.3          gtable_0.1.2        labeling_0.2       
## [13] lattice_0.20-27     LearnBayes_2.12     MASS_7.3-30        
## [16] Matrix_1.1-2-2      munsell_0.4.2       nlme_3.1-115       
## [19] plyr_1.8.1          png_0.1-7           proto_0.3-10       
## [22] pxR_0.29            RColorBrewer_1.0-5  Rcpp_0.11.1        
## [25] reshape_0.8.4       reshape2_1.2.2      RgoogleMaps_1.2.0.5
## [28] RJSONIO_1.0-3       scales_0.2.3        spdep_0.5-71       
## [31] splines_3.0.3       stringr_0.6.2       tools_3.0.3        
## [34] XML_3.95-0.2
</code></pre></div>
  </div>

  </article>

  <footer class="site-footer">
      <div class="container">
          &copy; 2014 
          
          <nav>
              <a href="http://ropengov.github.io/">rOpenGov</a> &middot;
              <a href="/">Blog</a> &middot;
              
              
          </nav>
          
          <nav class="social">
              
              <a href="https://twitter.com/ropengov" title="Follow on Twitter" target="_blank"><i class="icon icon-twitter black"></i></a>
              
                  
              <a href="/feed.xml" title="RSS Feed">
                  <i class="icon icon-rss black"></i>
              </a>
          </nav>
          <p>Incorporated theme by <a href="https://sendtoinc.com">Inc</a></p>
      </div>
  </footer>

  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="/assets/main.js"></script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=253595308025739";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<script>
    (function(d, t) {
        var g = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        g.src = '//hnbutton.appspot.com/static/hn.min.js';
        s.parentNode.insertBefore(g, s);
    }(document, 'script'));
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44262937-1', 'http://ropengov.github.io');
  ga('send', 'pageview');
</script>

  </body>
</html>